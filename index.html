<!DOCTYPE html>
<html lang="mr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Milk Register - Browser + Sheet Save</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f6; padding: 10px; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 15px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a73e8; font-size: 20px; }
        .header-actions { display: flex; justify-content: space-between; margin-bottom: 10px; gap: 5px; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
        th { background-color: #1a73e8; color: white; }
        .small-input { width: 35px; padding: 4px; border: 1px solid #ccc; border-radius: 3px; font-size: 12px; text-align: center; }
        .name-input { width: 120px; border: none; background: transparent; font-weight: bold; color: #333; }
        .btn { border: none; border-radius: 4px; cursor: pointer; color: white; transition: 0.3s; padding: 8px 15px; font-size: 14px; font-weight: bold;}
        .save-btn { background-color: #28a745; }
        .add-btn { background-color: #ff9800; font-size: 12px; padding: 5px 10px; }
        .delete-btn { color: #e74c3c; background: transparent; font-size: 16px; cursor: pointer; border: none;}
        .input-group { display: flex; gap: 3px; justify-content: center; }
        tr:nth-child(even) { background-color: #f9f9f9; }
    </style>
</head>
<body>

<div class="container">
    <h2>ü•õ ‡§Æ‡§ø‡§≤‡•ç‡§ï ‡§∞‡§ú‡§ø‡§∏‡•ç‡§ü‡§∞ (‡•®‡•¶‡•®‡•¨)</h2>
    
    <div class="header-actions">
        <button class="btn add-btn" onclick="addNewCustomer()">‚ûï Add New</button>
        <button id="saveButton" class="btn save-btn" onclick="saveData()">üíæ One-Click Save</button>
    </div>
    
    <table id="milkTable">
        <thead>
            <tr>
                <th>Code</th>
                <th>Name ‚úèÔ∏è</th>
                <th>Stop (4)</th>
                <th>Extra (4)</th>
                <th>‚ùå</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</div>

<script>
    // ‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§µ‡§∞‡•ç‡§° ‡§´‡§æ‡§à‡§≤‡§Æ‡§ß‡•Ä‡§≤ ‡§®‡§æ‡§µ‡•á
    let initialList = [
        {code: "AMS01", name: "‡§∏‡§ø‡§ß‡§® ‡§≠‡•á‡§ü‡•á‡§ï‡§∞"}, {code: "AMS02", name: "‡§Ö‡§®‡§ø‡§ï‡•á‡§§ ‡§¶‡•Å‡§ß"},
        {code: "AMS03", name: "‡§Æ‡•ã‡§†‡•á ‡§ú‡§æ‡§µ‡§® ‡§∏‡§∞"}, {code: "AMS04", name: "‡§∏‡§π‡•ç‡§Ø‡§æ‡§¶‡•ç‡§∞‡•Ä ‡§¶‡•Å‡§ß"},
        {code: "AMS05", name: "‡§∏‡§π‡•ç‡§Ø‡§æ‡§¶‡•ç‡§∞‡•Ä ‡§Æ‡•Ö‡§°‡§Æ"}, {code: "AMS06", name: "‡§¶‡•Å‡§ß ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ‡§™‡•Ç‡§ú‡§æ"},
        {code: "AMS07", name: "‡§ë‡§´‡§ø‡§∏"}, {code: "AMS08", name: "‡§∞‡§æ‡§ú‡•Ç ‡§Æ‡•á‡§ï‡•Ö‡§®‡§ø‡§ï"},
        {code: "AMS09", name: "‡§Æ‡•ã‡§†‡•á ‡§ú‡§æ‡§ß‡§µ‡§∏‡§∞ ‡§ú‡§µ‡§≥"}, {code: "AMS10", name: "‡§¶‡•Å‡§ß ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ‡§®‡§µ‡•Ä‡§®"},
        {code: "AMS11", name: "‡§∞‡§µ‡•Ä ‡§≠‡•à‡§Ø‡§æ ‡§¨‡§æ‡§ú‡•Ç‡§ö‡•á"}, {code: "AMS12", name: "‡§≠‡•á‡§ü‡•á‡§ï‡§∞ ‡§Æ‡•Ö‡§°‡§Æ"},
        {code: "AMS13", name: "‡§∞‡§µ‡•Ä ‡§≠‡•à‡§Ø‡•ç‡§Ø‡§æ"}, {code: "AMS14", name: "‡§™‡§µ‡§æ‡§∞ ‡§®‡§ó‡§∞ ‡§Æ‡•Ö‡§°‡§Æ"},
        {code: "AMS15", name: "‡§≠‡§æ‡§ä ‡§≠‡•à‡§Ø‡•ç‡§Ø‡§æ ‡§¶‡•Å‡§ß"}, {code: "AMS16", name: "‡§ó‡•ã‡§™‡§æ‡§≥ ‡§≠‡•à‡§Ø‡§æ ‡§™‡§æ‡§∂‡•Ä"},
        {code: "AMS17", name: "‡§∞‡§æ‡§†‡•ã‡§° ‡§∏‡§∞"}, {code: "AMS18", name: "‡§∏‡•ç‡§µ‡§æ‡§Æ‡•Ä ‡§µ‡§æ‡§≤‡•ç‡§Ø‡§æ‡§ö‡•ç‡§Ø‡§æ"},
        {code: "AMS19", name: "‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ‡§≠‡§æ‡§¶‡§æ"}, {code: "AMS20", name: "‡§Ü‡§≤‡§Æ‡§≤‡§æ ‡§∞‡•ã‡§° ‡•ß"},
        {code: "AMS21", name: "‡§Ü‡§≤‡§Æ‡§≤‡§æ ‡§∞‡•ã‡§° ‡•®"}, {code: "AMS22", name: "‡§ú‡§æ‡§ß‡§µ ‡§∏‡§∞ ‡§ó‡§≤‡•ç‡§≤‡•Ä"},
        {code: "AMS23", name: "‡§π‡•ã‡§≥‡§ï‡§∞ ‡§ó‡§≤‡•ç‡§≤‡•Ä ‡•ßL"}, {code: "AMS24", name: "‡§Ö‡§Æ‡•ã‡§≤ ‡§∏‡§∞ ‡§¶‡•Å‡§ß"},
        {code: "AMS25", name: "‡§Ü‡§ï‡§æ‡§∂ ‡§¨‡§ø‡§∞‡§æ‡§ú‡§¶‡§æ‡§∞"}, {code: "AMS26", name: "‡§ö‡§µ‡•ç‡§π‡§æ‡§£ ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞"},
        {code: "AMS27", name: "‡§Ü‡§ï‡§æ‡§∂ ‡§ò‡§∞‡§æ‡§™‡§æ‡§∂‡•Ä"}, {code: "AMS28", name: "‡§ï‡•ã‡§≥‡•Ä ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞"},
        {code: "AMS29", name: "‡§∏‡§æ‡§≥‡•Å‡§Ç‡§ï‡•á ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞"}, {code: "AMS30", name: "‡§µ‡§ø‡§†‡•ç‡§†‡§≤ ‡§Æ‡§æ‡§Æ‡§æ"},
        {code: "AMS31", name: "‡§∞‡§æ‡§†‡•ã‡§° ‡§∏‡§∞ ‡•ß/‡•®-‡•ß"}, {code: "AMS32", name: "‡§∞‡§æ‡§†‡•ã‡§° ‡§∏‡§∞ ‡•ß/‡•®-‡•®"},
        {code: "AMS33", name: "‡§∞‡§ø‡§ï‡•ç‡§∑‡§æ‡§µ‡§æ‡§≤‡•á ‡§®‡§µ‡•Ä‡§®"}, {code: "AMS34", name: "‡§ó‡•ã‡§™‡§æ‡§≥ ‡§≠‡•à‡§Ø‡§æ ‡•®"},
        {code: "AMS35", name: "‡§Æ‡§π‡§æ‡§∞‡•Å‡§¶‡•ç‡§∞ ‡§¨‡•á‡§°‡§ú‡§µ‡§≥‡§ó‡•á"}, {code: "AMS36", name: "‡§ó‡§Ç‡§™‡•Ç ‡§¨‡§ø‡§∞‡§æ‡§ú‡§¶‡§æ‡§∞"},
        {code: "AMS37", name: "‡§¨‡§∏ ‡§∏‡•ç‡§ü‡§Å‡§° ‡§î‡§∏‡§æ"}, {code: "AMS38", name: "‡§¨‡§æ‡§≤‡§æ‡§ú‡•Ä ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§ø‡§ï"},
        {code: "AMS39", name: "‡§Ö‡§≤‡§Æ‡§≤‡§æ ‡§∏‡§∞ ‡§µ‡•à‡§ú‡§µ‡§æ‡§°‡•á"}, {code: "AMS40", name: "‡§™‡§æ‡§ü‡•Ä‡§≤ ‡§ó‡§≤‡•ç‡§≤‡•Ä ‡•ß"}
    ];

    let customers = [];
    // ‡§ü‡•Ä‡§™: ‡§§‡•Å‡§Æ‡§ö‡•Ä Google Script URL ‡§ñ‡§æ‡§≤‡•Ä‡§≤ ‡§∏‡§ø‡§Ç‡§ó‡§≤ ‡§ï‡•ã‡§ü‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§ü‡§æ‡§ï‡§æ
    const scriptURL = '‡§Ø‡•á‡§•‡•á_‡§§‡•Å‡§Æ‡§ö‡•Ä_URL_‡§ü‡§æ‡§ï‡§æ'; 

    function loadTable() {
        // ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞‡§Æ‡§ß‡•Ç‡§® ‡§ï‡§∏‡•ç‡§ü‡§Æ‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü ‡§Ü‡§£‡§ø ‡§°‡•á‡§ü‡§æ ‡§Æ‡§ø‡§≥‡§µ‡§£‡•á
        const storedList = JSON.parse(localStorage.getItem('cust_list'));
        customers = storedList ? storedList : [...initialList];
        
        const storedData = JSON.parse(localStorage.getItem('milk_data')) || {};
        const tableBody = document.getElementById('tableBody');
        tableBody.innerHTML = "";

        customers.forEach((cust, index) => {
            let row = `<tr>
                <td>${cust.code}</td>
                <td>
                    <input type="text" class="name-input" value="${cust.name}" onchange="updateName(${index}, this.value)">
                </td>
                <td>
                    <div class="input-group">
                        ${[1,2,3,4].map(i => `<input type="text" class="small-input" id="s-${cust.code}-${i}" value="${storedData[`s-${cust.code}-${i}`] || ''}">`).join('')}
                    </div>
                </td>
                <td>
                    <div class="input-group">
                        ${[1,2,3,4].map(i => `<input type="text" class="small-input" id="e-${cust.code}-${i}" value="${storedData[`e-${cust.code}-${i}`] || ''}">`).join('')}
                    </div>
                </td>
                <td><button class="delete-btn" onclick="deleteCust(${index})">üóë</button></td>
            </tr>`;
            tableBody.innerHTML += row;
        });
    }

    function updateName(index, newName) {
        customers[index].name = newName;
        localStorage.setItem('cust_list', JSON.stringify(customers));
    }

    function addNewCustomer() {
        let newName = prompt("‡§®‡§µ‡•Ä‡§® ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï‡§æ‡§ö‡•á ‡§®‡§æ‡§µ ‡§ü‡§æ‡§ï‡§æ:");
        if (newName) {
            let lastCode = customers.length > 0 ? customers[customers.length - 1].code : "AMS00";
            let newCode = "AMS" + (parseInt(lastCode.replace("AMS", "")) + 1).toString().padStart(2, '0');
            customers.push({code: newCode, name: newName});
            localStorage.setItem('cust_list', JSON.stringify(customers));
            loadTable();
        }
    }

    function deleteCust(index) {
        if(confirm("‡§°‡§ø‡§≤‡•Ä‡§ü ‡§ï‡§∞‡§æ‡§Ø‡§ö‡•á?")) {
            customers.splice(index, 1);
            localStorage.setItem('cust_list', JSON.stringify(customers));
            loadTable();
        }
    }

    async function saveData() {
        const saveBtn = document.getElementById('saveButton');
        saveBtn.innerText = "‚è≥ Saving...";
        
        const dataToSave = {};
        customers.forEach(cust => {
            for(let i=1; i<=4; i++) {
                dataToSave[`s-${cust.code}-${i}`] = document.getElementById(`s-${cust.code}-${i}`).value;
                dataToSave[`e-${cust.code}-${i}`] = document.getElementById(`e-${cust.code}-${i}`).value;
            }
        });

        // ‡•ß. ‡§∏‡§∞‡•ç‡§µ‡§æ‡§§ ‡§Ü‡§ß‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á (LocalStorage) ‡§∏‡•á‡§µ‡•ç‡§π ‡§ï‡§∞‡§æ
        localStorage.setItem('milk_data', JSON.stringify(dataToSave));
        console.log("Browser ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡§æ.");

        // ‡•®. ‡§§‡•ç‡§Ø‡§æ‡§®‡§Ç‡§§‡§∞ Google Sheet ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§™‡§æ‡§†‡§µ‡§£‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§™‡•ç‡§∞‡§Ø‡§§‡•ç‡§® ‡§ï‡§∞‡§æ
        if (!scriptURL || scriptURL.includes('‡§Ø‡•á‡§•‡•á_‡§§‡•Å‡§Æ‡§ö‡•Ä_URL_‡§ü‡§æ‡§ï‡§æ')) {
            alert("‡§Æ‡§æ‡§π‡§ø‡§§‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡•Ä ‡§Ü‡§π‡•á! (Google Sheet ‡§∏‡§æ‡§†‡•Ä ‡§§‡•Å‡§Æ‡§ö‡•Ä URL ‡§ï‡•ã‡§°‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§™‡•á‡§∏‡•ç‡§ü ‡§ï‡§∞‡§æ)");
            saveBtn.innerText = "üíæ One-Click Save";
            return;
        }

        try {
            await fetch(scriptURL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(dataToSave)});
            alert("‡§°‡•á‡§ü‡§æ ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞ ‡§Ü‡§£‡§ø Google Sheet ‡§¶‡•ã‡§®‡•ç‡§π‡•Ä‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡§æ!");
        } catch (e) { 
            alert("‡§¨‡•ç‡§∞‡§æ‡§â‡§ù‡§∞‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§∏‡•á‡§µ‡•ç‡§π ‡§ù‡§æ‡§≤‡•á, ‡§™‡§£ Sheet Error ‡§Ü‡§≤‡•Ä!"); 
        }
        
        saveBtn.innerText = "üíæ One-Click Save";
    }

    window.onload = loadTable;
</script>

</body>
</html>